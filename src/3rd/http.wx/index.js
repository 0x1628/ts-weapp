!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).http={})}(this,function(t){"use strict";var o=function(t){return new Promise(function(o,u){wx.request({url:t.url,data:t.data||{},header:t.headers||{},method:(t.method||"get").toUpperCase(),success:function(t){var e=function(t){if(204===t.status)return!1;if(0===Number(t.contentLength))return!1;var e=t.contentType;return!!e&&e.includes("application/json")}({status:t.statusCode,contentLength:(t.header||{})["content-length"],contentType:(t.header||{})["content-type"]}),n=t.data;if("string"==typeof n&&e)try{n=JSON.parse(n)}catch(t){}var r={data:n,status:t.statusCode,headers:t.header};300<=t.statusCode?u(r):o(r)},fail:function(t){u({data:t.data||t,status:t.statusCode||500,headers:t.header||{}})}})})},u=function(){return(u=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},e=(n.prototype.request=function(t){var e=this,n=this._makeURL(t),r=this.defaults.transformRequest.reduce(function(t,e){return e(t)},t);return o(u({},r,{method:t.method,url:n})).then(function(n){return e.defaults.transformResponse.reduce(function(t,e){return e(n)},n)})},n.prototype._makeURL=function(t){var e=t.url;if(e.startsWith("http")||(e=""+(this.defaults.baseURL||"")+t.url),t.query){var n=t.query;"object"==typeof n&&(n=function(n){return Object.keys(n).reduce(function(t,e){return t+"&"+e+"="+(n[e]||"")},"").slice(1)}(n)),e+=(e.includes("?")?"&":"?")+n}return e},n.prototype._noDataMethod=function(t,e,n){return this.request(u({},n,{method:t,url:e}))},n.prototype._dataMethod=function(t,e,n,r){return this.request(u({},r,{method:t,url:e,data:n}))},n.prototype.get=function(t,e){return this._noDataMethod("get",t,e)},n.prototype.options=function(t,e){return this._noDataMethod("options",t,e)},n.prototype.delete=function(t,e){return this._noDataMethod("delete",t,e)},n.prototype.head=function(t,e){return this._noDataMethod("head",t,e)},n.prototype.post=function(t,e,n){return this._dataMethod("post",t,e,n)},n.prototype.patch=function(t,e,n){return this._dataMethod("patch",t,e,n)},n.prototype.put=function(t,e,n){return this._dataMethod("put",t,e,n)},n);function n(t){this.defaults={baseURL:"",headers:{},withCredentials:!1,timeout:1e3,transformRequest:[],transformResponse:[]},t&&(this.defaults=u({},this.defaults,t))}var r=new e;t.create=function(t){return new e(t)},t.http=r});
